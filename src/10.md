# script setup 新語法糖

在 Vue3.2 版本正式 RC 的功能，在 3.2 版以前使用都會跳出實驗性的提示文字，script setup 帶來 Vue3 新的語法糖，更加簡化了撰寫的方式，以下列幾點：

1.  屬性及函式不需手動 return，可直接使用在模板上，只需要定義在 script setup 內部
2.  元件自動註冊，不需要使用 components 屬性去註冊元件，只要把檔案引入會依照引入的名子為主
3.  可直接全域定義 directive
4.  script setup 可以跟 script 一起使用
5.  script setup 預設為 async，可直接內部使用 await
6.  接收 props 方式，改用 defineProps，其餘 attrs、slots 、 emits 等方式，使用 useAttrs、useSlots、defineEmits（ defineProps、defineEmits 可不需從 vue 提取出來，就能直接使用）

## script setup - 起手式 <div id="vue-setup_first"></div>

使用此語法糖只需在 script 標籤加上 setup 關鍵字，就已經套用 script setup 語法糖了，裡面所下的變數及函式不需要 return，只要是寫在<span style="color:red;">script setup</span>內，在模板內都能直接使用！

> 起手式範例：

```javascript=
<template>
  <h1> {{ text }} </h1>
</template>

<script setup>
import { ref } from "vue";
const text =  ref('起手式')
</script>
```

> 在這邊會遇到的 ESlint 的錯誤提示需要在，此組件設定 name 的名稱否則會報錯，在 script setup 目前還沒有支援 name 屬性，如果需要加入 name 的屬性，可以再增加一個 script 標籤 ，或者可以另外安裝套件來解決此問題！
> 以下為範例 :

```javascript=
<template>
  <h1>{{ text }}</h1>
</template>

<script setup>
import { ref } from "vue";
const text = ref("起手式");
</script>

// 定義組件名稱用
<script>
export default {
  name: "TestComponent",
};
</script>
```

## script setup - 自動註冊元件 <div id="vue-setup_component"></div>

直接在<span style="color:red;">script setup</span>內中，引入需要的元件，不需要透過 components 屬性進行註冊，會自動使用引入的檔名為主。

> 以下為範例 :

```javascript=
// 父組件
<template>
  <Test />
</template>

<script setup>
// 引入進來並自動註冊，可直接在模板使用
import Test from "@/components/Test.vue";
</script>
```

## script setup - 資料傳遞 <div id="vue-setup_props"></div>

在<span style="color:red;">setup()</span>函式裡，資料傳遞需要透過 props 屬性定義名稱，再透過在<span style="color:red;">setup()</span>函式的參數 prop 取得值，使用第二個參數 context.attrs 取得，如使用<span style="color:red;">script setup</span>，需使用 defineProps({})方法取得（ defineProps 不需從 vue 提取出來，可直接使用 ）

> 範例：

```javascript=
// 兩種取一種都能使用

// 第一種方法
<script setup>
defineProps({
  name: String,
});

// 第二種方法
import { toRefs } from "vue"
const props = defineProps({
  name: String,
});
const { name } = toRefs(props)

</script>
```

## script setup - emit 事件 : <div id="vue-setup_event"></div>

使用 emit 事件的方式，需使用 defineEmits([])方法( defineEmits 不需從 vue 提取出來，可直接使用)，並設定 emit 事件的名稱，跟<span style="color:red;">setup()</span>函式一樣需先定義 emit 名稱才能使用。

> 範例 :

```javascript=
<script setup>
// 這邊需注意，defineEmits使用上與defineProps不同，使用defineEmits時需要先宣告一個變數，把defineEmits指派給該變數才能使用
const emit = defineEmits(["getChild"]);
const emitHandler = () => emit("emit-handler");
</script>
```

## script setup - expose( 限制組件對外的參數 ) : <div id="vue-setup_expose"></div>

在<span style="color:red;">script setup</span>裡定義的變數及函式，默認是不會暴露出去，需使用 defineExpose()方法，指定需要暴露的變數及函式，而<span style="color:red;">setup()</span>函式稍微相反，<span style="color:red;">setup()</span>函式，默認是暴露裡面所有的變數及函式，如需限制，需使用 context.expose()來設定要暴露的值。

> 範例 :

```javascript=
// 子組件
<script setup>
import { ref } from 'vue'
const text = ref("子組件");
// defineExpose()不需要從vue提取出來，可直接使用
defineExpose({
 text
});
</script>
```

```javascript=
// 父組件
<template>
 <Test ref="child" />
</template>

<script setup>
import { ref, onMounted } from 'vue'
import Test from './components/test.vue'

const child = ref(null);
onMounted(() => {
 console.log(child.value.text); // 子組件
})
</script>
```

## script setup - attrs(屬性) & slots(插槽) : <div id="vue-setup_attrs-slots"></div>

<span style="color:red;">useAttrs() & useSlots()</span>，兩個屬性使用方式與 emit 一樣，宣告變數把<span style="color:red;">useAttrs() & useSlots()</span>方法指派給變數使用。

> 範例 :

```javascript=
<script setup>
 // 使用方式需要從vue提取出來， ( 而defineProps、defineEmits、defineExpose不需要 )
 import { useAttrs, useSlots } from 'vue'
 const slots = useSlots();
 const attrs = useAttrs();
</script>
```
