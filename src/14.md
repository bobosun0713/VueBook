# Render Function 
在大多數Vue官方推薦用模板來創件，但有時候一些場景，需要透過JS做邏輯操作，這時候使用render function(渲染函式)，來創建更佳容易且彈性。


<!--sec data-title="範例 :" data-id="section1" data-show=true ces-->

> [!comment]
> 採用Vue官方的例子來解釋 : 使用 “模版” 或 “渲染函式” 之間的使用上的差異性 <span style="color:red;"> ( 個人習慣使用模板語法撰寫組件時，會採用.vue副檔名撰寫，而使用runder funciton(函數式)的方式，會採用 .js 附檔名來撰寫，以上兩種看個人習慣來撰寫 !! ）</span>

- 以模板來說依照不同 level 等級來渲染的標籤，這些都是正常使用上的方式，但透過以下代碼就能發現多寫 “很多的判斷及重複的代碼”
  
```xml
<!-- tag.vue -->
<template>
  <h1 v-if="level === 1">
    <slot></slot>
  </h1>
  <h2 v-else-if="level === 2">
    <slot></slot>
  </h2>
  <h3 v-else-if="level === 3">
    <slot></slot>
  </h3>
</template>
```

- 如果採用 “render function(渲染函式)”，可以簡化以上的代碼，透過以下代碼只要關注 props 傳入的參數，且不用多做邏輯判斷顯示，非常簡潔！

```js
// tag.js
// 這邊採用 Vue3 寫法，使用 setup 方式，注意不能使用 script setup 語法糖的寫法（目前還不支援
import { h } from 'vue';
export default {
  name: 'Tag',
  props: {
    level: {
      type: String,
      default: 'h1'
    }
  },
  setup(props, { slots }) {
    return () => h(props.level, slots.default());
  }
}
```

<!--endsec-->

透過以上的範例也就能明白，使用 render function(渲染函式)在某些業務上，帶來的許多彈性

> [!warning]
> 在 vue3 的 composition api 中 setup() 函式裡使用 “render function(渲染函式)” 不用特別聲明 render() 函式，可使用 return 的方式回傳，但注意不能直接回傳 h()函式，需透過 return () => h()的方式回傳!



## h() 參數

h() 函式是一個用於創造 VNode 節點，可用來搭配 render function(渲染函式) 來使用的函式。

> [!note]
> h()函式 可帶入三個參數 :
    1. type（必填） <string | Component> : html標籤名稱 或 傳入 Component
    2. props (非必填) <object | null> : 可傳入class、src、props、event..等等的attribute屬性
    3. vnode (非必填) <String | Array | Object> : 可放入 VNode 或 slot 內容或純文字

<!--sec data-title="h()渲染的示意圖 :" data-id="section2" data-show=true ces-->
 
```xml
    示意 1
    ---
    (渲染前)
    h( 'div', { class:'text' } , 'render function' )

    (選染後)
    <div class="text"> 'render function' </div>

    示意 2
    ---
    (渲染前)
    h( 'div', { class:'text' } , [ render function , slots.default ] )
        
    (渲染後)       
    <div class="text">
        render function 
        <slot></slot>
    </div>
```

> [!warning]
> 需注意使用 h() 函式，渲然 slot 標籤時，是無法像模板語法給予 slot 標籤預設的值！

使用 h() 渲染函式來渲染 slot 標籤，如何渲染 default 值的個人解法為：

```js
export default {
    // 以下代碼過濾排除 comment 標籤
    const filterTag = slots
      .default?.({ row: props.row, data: props.data })
      .filter(item => item?.type?.description !== 'Comment');
      
    setup(props, { slots }) {
    // 當 filterTag 等於 undefine 顯示預設值，反之顯示傳入的值
     return filterTag?.length ? filterTag : props.row;
    }
}
```
  
<!--endsec-->

## Vue3 與 Vue2 中使用 render function(渲染函式)的區別

- Vue2 : 
  1. render() 函式會自帶 createElement 參數，通常參數會簡寫為 h
  2. 當設置為函數式組件時( functional:true )，没有實例 (沒有this 上下文)，其 增加context的參數來取得 slot、props...等參數

- Vue3 : 在 Vue3 中可以撰寫兩種風格 Option API 或 Composition API，在此分別解釋兩種區別。
  1. Option API :
     - render 函式將不自帶參數，而是把 h 參數改成全域使用，需從 Vue 提取出來。
     - 不在有 functional 屬性 (官方解釋：狀態組件和函數式組件之間的性能差異已經大大減少，已被移除！)。

  2. Composition API :
     - h() 用法與 Option API 寫法一樣，需從 Vue 提取出來！
     - 使用 setup 函式撰寫，不需再寫 render 函式，而是從 setup 函式裡 return 函式回傳 h() 函式來創建標籤 <span style="color:red;"> (在 setup 函式裡回傳的值是函式的話，會返 render 函數，所以在 setup 函式中使用 h() 函式，並不用特別聲明 render() 函式）
  
